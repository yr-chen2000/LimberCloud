(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     18126,        476]
NotebookOptionsPosition[     16808,        449]
NotebookOutlinePosition[     17201,        465]
CellTagsIndexPosition[     17158,        462]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 TemplateBox[{
   Cell[
    TextData[
     Cell[
      BoxData[
       FormBox[
        TemplateBox[<|"boxes" -> FormBox[
            RowBox[{
              SubsuperscriptBox[
               StyleBox["B", "TI"], 
               RowBox[{"\[Phi]\[Phi]", ",", 
                 StyleBox["n", "TI"]}], 
               RowBox[{
                 StyleBox["i", "TI"], "\[LongEqual]", 
                 StyleBox["n", "TI"], "<", 
                 StyleBox["N", "TI"], ",", 
                 StyleBox["j", "TI"], "\[LongEqual]", 
                 StyleBox["n", "TI"], "<", 
                 StyleBox["N", "TI"]}]], "\[LongEqual]", 
              SubsuperscriptBox["\[Integral]", 
               SubscriptBox["\[Chi]", 
                StyleBox["n", "TI"]], 
               SubscriptBox["\[Chi]", 
                RowBox[{
                  StyleBox["n", "TI"], "+", "1"}]]], 
              StyleBox["d", FontSlant -> "Plain"], "\[Chi]", 
              SuperscriptBox[
               RowBox[{"(", 
                 FractionBox[
                  RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]], "-", "\[Chi]"}], 
                  RowBox[{"\[Chi]", "(", 
                    RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]], "-", 
                    SubscriptBox["\[Chi]", 
                    StyleBox["n", "TI"]]}], ")"}]], ")"}], "2"], 
              RowBox[{"(", 
                RowBox[{
                  FractionBox[
                   RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]], "-", "\[Chi]"}], 
                   RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]], "-", 
                    SubscriptBox["\[Chi]", 
                    StyleBox["n", "TI"]]}]], 
                  SubsuperscriptBox[
                   StyleBox["P", "TI"], "\[ScriptL]", 
                   StyleBox["n", "TI"]], "+", 
                  FractionBox[
                   RowBox[{"\[Chi]", "-", 
                    SubscriptBox["\[Chi]", 
                    StyleBox["n", "TI"]]}], 
                   RowBox[{
                    SubscriptBox["\[Chi]", 
                    RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]], "-", 
                    SubscriptBox["\[Chi]", 
                    StyleBox["n", "TI"]]}]], 
                  SubsuperscriptBox[
                   StyleBox["P", "TI"], "\[ScriptL]", 
                   RowBox[{
                    StyleBox["n", "TI"], "+", "1"}]]}], ")"}]}], 
            TraditionalForm], "errors" -> {}, "input" -> 
          "B^{i = n < N, j = n < N}_{\\phi \\phi,n} = \
\\int_{\\chi_{n}}^{\\chi_{n + 1}} \\mathrm{d} \\chi \\left(\\frac{\\chi_{n + \
1} - \\chi}{\\chi (\\chi_{n + 1} - \\chi_n)}\\right)^2 \\left( \
\\frac{\\chi_{n + 1} - \\chi}{\\chi_{n + 1} - \\chi_n} P_\\ell^{n} + \
\\frac{\\chi - \\chi_n}{\\chi_{n + 1} - \\chi_n} P_\\ell^{n + 1} \\right)", 
          "state" -> "Boxes"|>, "TeXAssistantTemplate"], TraditionalForm]]]], 
    "Text", CellChangeTimes -> {3.8871962707037907`*^9}]},
  "Canvas"]], "InlineFormula",
 CellChangeTimes->{{3.908421086359544*^9, 3.908421118617532*^9}, 
   3.975764424767662*^9},ExpressionUUID->"4f4f557d-776e-4dd5-94a7-\
b2d3c398dfbf"],

Cell[TextData[Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        SubsuperscriptBox[
         StyleBox["B", "TI"], 
         RowBox[{"\[Phi]\[Phi]", ",", "0"}], 
         RowBox[{
           StyleBox["i", "TI"], "\[LongEqual]", "0", ",", 
           StyleBox["j", "TI"], "\[LongEqual]", "0"}]], "\[LongEqual]", 
        SubsuperscriptBox["\[Integral]", "0", 
         SubscriptBox["\[Chi]", "1"]], 
        StyleBox["d", FontSlant -> "Plain"], "\[Chi]", 
        SuperscriptBox[
         RowBox[{"(", 
           FractionBox[
            RowBox[{
              SubscriptBox["\[Chi]", "1"], "-", "\[Chi]"}], 
            SubscriptBox["\[Chi]\[Chi]", "1"]], ")"}], "2"], 
        RowBox[{"(", 
          RowBox[{
            FractionBox[
             SuperscriptBox["\[Chi]", "3"], 
             SubsuperscriptBox["\[Chi]", "1", "3"]], 
            SubsuperscriptBox[
             StyleBox["P", "TI"], "\[ScriptL]", "1"]}], ")"}]}], 
      TraditionalForm], "errors" -> {}, "input" -> 
    "B^{i = 0, j = 0}_{\\phi \\phi,0} = \\int_{0}^{\\chi_{1}} \\mathrm{d} \
\\chi \\left(\\frac{\\chi_{1} - \\chi}{\\chi \\chi_{1}}\\right)^2 \\left( \
\\frac{\\chi^3}{\\chi_{1}^3}P_\\ell^{1} \\right)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], 
  TraditionalForm]],ExpressionUUID->"b867b033-ef5a-4015-94d5-f571fdc44868"]], \
"InlineFormula",
 CellChangeTimes->{
  3.975765019575478*^9},ExpressionUUID->"acc2f9c4-0cb8-4f7d-b207-\
41be6db82b69"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["t", "TI"], "\[LongEqual]", 
         FractionBox["\[Chi]", 
          SubscriptBox["\[Chi]", 
           RowBox[{
             StyleBox["n", "TI"], "+", "1"}]]]}], TraditionalForm], 
     "errors" -> {}, "input" -> "t = \\frac{\\chi}{\\chi_{n + 1}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4912d5c3-8324-4d69-b599-aa8184e5949f"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["p", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubsuperscriptBox[
             StyleBox["P", "TI"], "\[ScriptL]", 
             RowBox[{
               StyleBox["n", "TI"], "+", "1"}]], "-", 
            SubsuperscriptBox[
             StyleBox["P", "TI"], "\[ScriptL]", 
             StyleBox["n", "TI"]]}], 
          SubsuperscriptBox[
           StyleBox["P", "TI"], "\[ScriptL]", 
           RowBox[{
             StyleBox["n", "TI"], "+", "1"}]]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "p = \\frac{P_\\ell ^{n + 1}- P_\\ell^{n}}{P_\\ell^{n + 1}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "2eee0d46-505d-4d0b-a58e-a80e9d4b755e"],
 ", ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         StyleBox["a", "TI"], "\[LongEqual]", 
         FractionBox[
          RowBox[{
            SubscriptBox["\[Chi]", 
             RowBox[{
               StyleBox["n", "TI"], "+", "1"}]], "-", 
            SubscriptBox["\[Chi]", 
             StyleBox["n", "TI"]]}], 
          SubscriptBox["\[Chi]", 
           RowBox[{
             StyleBox["n", "TI"], "+", "1"}]]]}], TraditionalForm], 
     "errors" -> {}, "input" -> 
     "a = \\frac{\\chi_{n + 1}- \\chi_{n}}{\\chi_{n + 1}}", "state" -> 
     "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "69617031-5055-4d50-8a01-737971c02fd9"]
}], "InlineFormula",
 CellChangeTimes->{{3.887196302307176*^9, 3.887196331440764*^9}, {
   3.887196362536772*^9, 3.887196382134186*^9}, {3.9084206984864616`*^9, 
   3.9084207040669937`*^9}, {3.9089269911816826`*^9, 3.9089270153600936`*^9}, 
   3.911872643072219*^9, {3.9167297782225657`*^9, 3.916729779861895*^9}, {
   3.9167302875097713`*^9, 
   3.9167302877176776`*^9}},ExpressionUUID->"7b6246ea-d307-486a-90da-\
c05c2c9b0953"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["B", "TI"], 
          RowBox[{"\[Phi]\[Phi]", ",", 
            StyleBox["n", "TI"]}], 
          RowBox[{
            StyleBox["i", "TI"], "\[LongEqual]", 
            StyleBox["n", "TI"], "<", 
            StyleBox["N", "TI"], ",", 
            StyleBox["j", "TI"], "\[LongEqual]", 
            StyleBox["n", "TI"], "<", 
            StyleBox["N", "TI"]}]], "\[LongEqual]", 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["P", "TI"], "\[ScriptL]", 
           RowBox[{
             StyleBox["n", "TI"], "+", "1"}]], 
          SubscriptBox["\[Chi]", 
           RowBox[{
             StyleBox["n", "TI"], "+", "1"}]]], 
         SubscriptBox[
          StyleBox["I", "TI"], "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "B^{i = n < N, j = n < N}_{\\phi \\phi, n}  =  \\frac{P_\\ell^{n + \
1}}{\\chi_{n+1}} I_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "4b752b2d-bf88-49b4-a30f-b6880a709dfe"],
 "\n",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       RowBox[{
         SubsuperscriptBox[
          StyleBox["B", "TI"], 
          RowBox[{"\[Phi]\[Phi]", ",", "0"}], 
          RowBox[{
            StyleBox["i", "TI"], "\[LongEqual]", "0", ",", 
            StyleBox["j", "TI"], "\[LongEqual]", "0"}]], "\[LongEqual]", 
         FractionBox[
          SubsuperscriptBox[
           StyleBox["P", "TI"], "\[ScriptL]", "1"], 
          SubscriptBox["\[Chi]", "1"]], 
         SubscriptBox[
          StyleBox["J", "TI"], "1"]}], TraditionalForm], "errors" -> {}, 
     "input" -> 
     "B^{i = 0, j = 0}_{\\phi \\phi, 0}  =  \\frac{P_\\ell^{1}}{\\chi_{1}} \
J_1", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "c52182b1-549a-41bf-94be-7e3d29946b15"]
}], "InlineFormula",
 CellChangeTimes->{
  3.887196401920412*^9, 3.916729808330739*^9, 3.916730295642751*^9, {
   3.916730483455694*^9, 
   3.916730485009008*^9}},ExpressionUUID->"21cd44dd-49c8-44f7-a1b3-\
e5707dd0452b"],

Cell[TextData[Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        SubscriptBox[
         StyleBox["I", "TI"], "1"], "\[LongEqual]", 
        SubsuperscriptBox["\[Integral]", 
         RowBox[{"1", "-", 
           StyleBox["a", "TI"]}], "1"], 
        StyleBox["d", FontSlant -> "Plain"], 
        StyleBox["t", "TI"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
           FractionBox[
            RowBox[{"1", "-", 
              StyleBox["t", "TI"]}], 
            RowBox[{
              StyleBox["a", "TI"], 
              StyleBox["t", "TI"]}]], ")"}], "2"], 
        RowBox[{"(", 
          RowBox[{"1", "-", 
            FractionBox[
             StyleBox["p", "TI"], 
             StyleBox["a", "TI"]], 
            RowBox[{"(", 
              RowBox[{"1", "-", 
                StyleBox["t", "TI"]}], ")"}]}], ")"}]}], TraditionalForm], 
    "errors" -> {}, "input" -> 
    "I_1 = \\int_{1-a}^{1} \\mathrm{d} t \\: \\left( \\frac{1-t}{a t} \
\\right)^2\\left( 1 - \\frac{p}{a} (1 - t) \\right)", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], 
  TraditionalForm]],ExpressionUUID->"f8d8d33b-26e6-44a7-ab4c-a2f5f26c6a82"]], \
"InlineFormula",
 CellChangeTimes->{
  3.887196539368146*^9, {3.916730335251473*^9, 3.9167303405683413`*^9}, {
   3.9167304899218407`*^9, 3.9167304922595234`*^9}, {3.975764531420774*^9, 
   3.975764531974576*^9}},ExpressionUUID->"2e461cf4-f0f3-4eef-ba1c-\
97aa73b03444"],

Cell[TextData[Cell[BoxData[
 FormBox[
  TemplateBox[<|"boxes" -> FormBox[
      RowBox[{
        SubscriptBox[
         StyleBox["J", "TI"], "1"], "\[LongEqual]", 
        SubsuperscriptBox["\[Integral]", "0", "1"], 
        StyleBox["d", FontSlant -> "Plain"], 
        StyleBox["t", "TI"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
           FractionBox[
            RowBox[{"1", "-", 
              StyleBox["t", "TI"]}], 
            StyleBox["t", "TI"]], ")"}], "2"], 
        SuperscriptBox[
         StyleBox["t", "TI"], "3"]}], TraditionalForm], "errors" -> {}, 
    "input" -> 
    "J_1 = \\int_{0}^{1} \\mathrm{d} t \\: \\left( \\frac{1-t}{t} \\right)^2 \
t^3", "state" -> "Boxes"|>,
   "TeXAssistantTemplate"], 
  TraditionalForm]],ExpressionUUID->"a8d16a31-c7cc-4672-9a13-e4e239bb0ae3"]], \
"InlineFormula",
 CellChangeTimes->{
  3.975764539437738*^9},ExpressionUUID->"c7ed4fd1-4ed5-46c1-a74b-\
7ab33765ab79"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"I1", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", "-", " ", "t"}], 
         RowBox[{"a", " ", "t"}]], ")"}], "2"], 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{
         FractionBox["p", "a"], 
         RowBox[{"(", 
          RowBox[{"1", "-", "t"}], ")"}]}]}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", 
       RowBox[{"1", "-", "a"}], ",", "1"}], "}"}], ",", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"Element", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"a", ",", "p"}], "}"}], ",", "Reals"}], "]"}], "&&", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"a", ",", "p"}], "}"}], "<", "1"}], " ", "&&", " ", 
       RowBox[{"a", " ", ">", "0"}]}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8871966515420856`*^9, 3.887196657849538*^9}, {
   3.887197019461763*^9, 3.8871970202578783`*^9}, 3.887197391169403*^9, 
   3.8876346041182613`*^9, {3.8879047776300783`*^9, 3.887904807663855*^9}, {
   3.887904924599154*^9, 3.887904942996567*^9}, 3.888148387380184*^9, {
   3.908927033760575*^9, 3.908927045576909*^9}, {3.9118670786093025`*^9, 
   3.911867115834875*^9}, {3.9118682919395266`*^9, 3.9118682935050373`*^9}, {
   3.911871007741147*^9, 3.91187101680612*^9}, 3.9118715300543127`*^9, 
   3.9118727166245546`*^9, {3.9118736647145653`*^9, 3.91187366700858*^9}, {
   3.916287078688748*^9, 3.916287092553621*^9}, {3.9757645584098063`*^9, 
   3.975764570886302*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"43640b55-9bdb-44d4-99fa-5150f7081833"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "a"}], ")"}], " ", "a"}], "+", 
       RowBox[{"6", " ", "p"}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", "a"}], ")"}], " ", "p"}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "a"}], ")"}]}]], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "a"}], "-", 
      RowBox[{"3", " ", "p"}]}], ")"}], " ", 
    RowBox[{"Log", "[", 
     RowBox[{"1", "-", "a"}], "]"}]}]}], 
  SuperscriptBox["a", "3"]]], "Output",
 CellChangeTimes->{
  3.908927088915324*^9, 3.909560342798202*^9, {3.911867098520398*^9, 
   3.911867124875881*^9}, 3.911868302300482*^9, {3.9118710209498997`*^9, 
   3.911871030870554*^9}, {3.9118714935877266`*^9, 3.911871516069235*^9}, 
   3.9118715479604073`*^9, 3.911871728501156*^9, 3.9118727227860403`*^9, 
   3.9118736764706955`*^9, 3.916287105068568*^9, 3.91629806383587*^9, 
   3.9167305150524263`*^9, 3.916731212806151*^9, {3.91681124173303*^9, 
   3.916811259532145*^9}, 3.9168188701869564`*^9, 3.91683448370582*^9, 
   3.916836538620756*^9, 3.9170280632221775`*^9, {3.975764619364303*^9, 
   3.9757646377322817`*^9}},
 CellLabel->"Out[1]=",ExpressionUUID->"fff11596-0767-48d6-9b00-c8acbe907c18"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"J1", "=", " ", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        FractionBox[
         RowBox[{"1", "-", " ", "t"}], "t"], ")"}], "2"], 
      RowBox[{"(", 
       SuperscriptBox["t", "3"], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.916730398496374*^9, 3.91673043740484*^9}, 
   3.916834468608283*^9, {3.917005815592227*^9, 3.9170058327619333`*^9}, {
   3.9170063601183786`*^9, 3.9170063602372456`*^9}, {3.975764589940284*^9, 
   3.9757645960966454`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"040cde03-8003-4644-8984-381561dbe67d"],

Cell[BoxData[
 FractionBox["1", "12"]], "Output",
 CellChangeTimes->{
  3.9170058349589787`*^9, 3.9170063685248117`*^9, 3.9170280651019096`*^9, {
   3.9757646195078287`*^9, 3.975764637919649*^9}},
 CellLabel->"Out[2]=",ExpressionUUID->"2d3a3431-7969-4235-a7db-b7ccd8605893"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"13.1 for Mac OS X ARM (64-bit) (June 16, 2022)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"19192549-899c-41b7-86b0-c7319d1b3f69"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 3488, 82, 52, "InlineFormula",ExpressionUUID->"4f4f557d-776e-4dd5-94a7-b2d3c398dfbf"],
Cell[4049, 104, 1467, 35, 48, "InlineFormula",ExpressionUUID->"acc2f9c4-0cb8-4f7d-b207-41be6db82b69"],
Cell[5519, 141, 2489, 66, 48, "InlineFormula",ExpressionUUID->"7b6246ea-d307-486a-90da-c05c2c9b0953"],
Cell[8011, 209, 2165, 58, 84, "InlineFormula",ExpressionUUID->"21cd44dd-49c8-44f7-a1b3-e5707dd0452b"],
Cell[10179, 269, 1446, 37, 44, "InlineFormula",ExpressionUUID->"2e461cf4-f0f3-4eef-ba1c-97aa73b03444"],
Cell[11628, 308, 933, 25, 44, "InlineFormula",ExpressionUUID->"c7ed4fd1-4ed5-46c1-a74b-7ab33765ab79"],
Cell[CellGroupData[{
Cell[12586, 337, 1703, 40, 48, "Input",ExpressionUUID->"43640b55-9bdb-44d4-99fa-5150f7081833"],
Cell[14292, 379, 1449, 37, 63, "Output",ExpressionUUID->"fff11596-0767-48d6-9b00-c8acbe907c18"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15778, 421, 737, 18, 48, "Input",ExpressionUUID->"040cde03-8003-4644-8984-381561dbe67d"],
Cell[16518, 441, 274, 5, 49, "Output",ExpressionUUID->"2d3a3431-7969-4235-a7db-b7ccd8605893"]
}, Open  ]]
}
]
*)

